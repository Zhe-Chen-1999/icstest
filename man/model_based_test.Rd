% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ics_tests.R
\name{model_based_test}
\alias{model_based_test}
\title{Model-Based Test for Informative Cluster Size}
\usage{
model_based_test(model_formula, interaction_term_name, model_data, cluster_id)
}
\arguments{
\item{model_formula}{An R formula (class `formula`) specifying the model,
including the interaction term between treatment and cluster size.}

\item{interaction_term_name}{A character string specifying the name of the interaction term between treatment and cluster size
(e.g., `"Z:cluster_size"`) for which the p-value will be returned.}

\item{model_data}{A data frame containing all the variables required by the `model_formula`:
the outcome, treatment assignment, cluster size, cluster index, and any covariates to be adjusted for.}

\item{cluster_id}{A vector or column in `model_data` indicating the cluster membership of each unit.}
}
\value{
A numeric value, the p-value for the interaction term between treatment and cluster size.
}
\description{
Performs a model-based test using generalized estimating equations for
informative cluster sizes in cluster randomized trials.
}
\examples{
library(geepack)

# Generate example data
n_clusters <- 20
cluster_sizes <- sample(20:80, n_clusters, replace = TRUE)
n <- sum(cluster_sizes)
cluster_id <- rep(1:n_clusters, cluster_sizes)
cluster_size <- cluster_sizes[cluster_id]
Z <- rep(rbinom(n_clusters, 1, 0.5), cluster_sizes)
Y0 <- rnorm(n) + rep(rnorm(n_clusters), cluster_sizes)
tau <- 0.5 * log(cluster_size)
Y <- Y0 + tau * Z

data <- data.frame(Y = Y, Z = Z, cluster_size = cluster_size,
                         cluster_id = cluster_id)

formula <- as.formula("Y ~ Z * log(cluster_size)")

# Run the test
model_based_test(formula, "Z:log(cluster_size)", data, cluster_id)
}
